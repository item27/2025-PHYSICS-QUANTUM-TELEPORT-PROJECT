# Quantum Teleportation Visualizer (MVP)

Веб-приложение, которое наглядно показывает протокол квантовой телепортации одного кубита. Доступны два режима:

- **Демонстрационный** — полностью локальная пошаговая визуализация без сервера.
- **Сетевой** — работа с backend через WebSocket, сервер управляет состояниями и шагами.

## Запуск backend

```bash
# из корня репозитория
PORT=8080 go run ./cmd/server
```

Доступные точки входа:
- `POST /api/sessions` — создать новую сессию телепортации;
- `GET /api/sessions/{id}` — получить состояние;
- `POST /api/sessions/{id}/join` — занять конкретную роль и получить токен подключения;
- `POST /api/sessions/{id}/advance` — продвинуть протокол вперёд;
- `GET /api/ws?session={id}&token=...` — WebSocket поток обновлений с проверкой роли;
- `POST /api/sessions/{id}/leave` — явный выход из роли (освобождает слот, если передан корректный токен);
- `GET /healthz` — проверка работоспособности.

Контракт описан в `api/openapi.yaml`.

## Запуск frontend

```bash
cd frontend
npm install
npm run dev # приложение на http://localhost:5173
```

Для сетевого режима убедитесь, что backend запущен на `http://localhost:8080` (можно изменить через `VITE_API_BASE` и `VITE_WS_BASE`).

### Многоклиентский сценарий

1. Пользователь A создаёт сессию (`POST /api/sessions`), получает ID и делится им.
2. Пользователь B вводит Session ID на странице «Сетевой режим», проверяет сессию и видит свободные/занятые роли.
3. Пользователь B выбирает свободную роль (например, Bob) и вызывает `POST /api/sessions/{id}/join`, получая токен. Повторный join с тем же токеном идемпотентен.
4. WebSocket подключается как `ws://.../api/ws?session={id}&token=...`; сервер знает роль клиента и рассылает обновления.
5. Пользователь C повторяет шаги для оставшейся роли. Роли нельзя занимать повторно: занятая роль вернёт HTTP 409 или освободится через `leave`/TTL.
6. Шаги протокола доступны только тем, чья роль разрешена на текущем этапе (Alice — измерение, Bob — коррекция, Charlie — запутывание). Кнопка «Шаг моей роли» активна только в состоянии подключённого клиента.
7. Чтобы освободить роль вручную, участник нажимает «Покинуть сессию» (REST `leave`), после чего слот снова отображается как свободный.

## Запуск через Docker

Поднять весь проект одной командой:

```bash
docker compose up --build
```

По умолчанию будут доступны порты:
- backend: `http://localhost:8080`
- frontend: `http://localhost:8081`

Настроить порты и адреса можно через переменные окружения перед запуском:
- `BACKEND_PORT` — внешний порт backend (по умолчанию 8080);
- `FRONTEND_PORT` — внешний порт frontend (по умолчанию 8081);
- `VITE_API_BASE` — адрес backend для сборки frontend (по умолчанию `http://localhost:8080` в docker-compose; при изменении BACKEND_PORT обновите эту переменную);
- `VITE_WS_BASE` — WebSocket-адрес backend для сборки frontend (по умолчанию `ws://localhost:8080`; при изменении BACKEND_PORT обновите эту переменную);
- `VITE_DOCS_URL` — ссылка на подробную документацию (если задана, показывается в футере интерфейса).

Остановить контейнеры:

```bash
docker compose down
```

## Структура

- `cmd/server` — точка входа Go-сервера.
- `internal/` — доменные модели, сервисы, транспортные слои.
- `api/` — OpenAPI контракт REST и WebSocket.
- `frontend/` — React + Vite + TypeScript клиент с двумя режимами работы.

Код и тексты написаны на простом русском языке, чтобы объяснять процесс людям без физического образования, сохраняя уважение к физике.

## Документация

- [Папка docs/](docs/)
- [Обзор проекта](docs/00_project_overview.md)
- [Пользовательская документация](docs/01_user_documentation.md)
- [Системные требования](docs/02_system_requirements.md)
- [Архитектура backend](docs/03_backend_architecture.md)
- [Архитектура frontend](docs/04_frontend_architecture.md)
- [Протокол WebSocket](docs/05_websocket_protocol.md)
- [План разработки](docs/06_development_plan.md)
- [Содержание документации](docs/README.md)

## Визуальные метафоры и физический контекст

- **Иконки шагов**: каждый этап помечен лаконичной SVG-иконкой (запутанность, измерение, классический канал, коррекция), чтобы быстро считывать физический смысл.
- **Формулы на фоне**: полупрозрачный слой с ключевыми символами (|ψ⟩, ⊗, |Φ⁺⟩, σₓ, σ_z) создаёт ощущение лабораторной доски.
- **Сфера Блоха**: у Алисы (до измерения) и Боба (во время коррекции) отображается упрощённая сфера с плавным дрейфом фазы и остановкой при коллапсе.
- **Инфо-алерты по шагам**: при смене шага выводятся короткие подсказки про необратимость измерения, классический канал и локальную коррекцию.
- Все эффекты — визуальные метафоры; протокол, шаги и API остаются без изменений.

## Пошаговый сценарий телепортации

1. **Подготовка состояния у Алисы**
   - Состояние: $|\psi\rangle = \alpha\,|0\rangle + \beta\,|1\rangle$.
   - Локальная суперпозиция, не связанная с другими кубитами.
   - Визуализация рисует исходный вектор на сфере Блоха.

2. **Создание пары Белла (Чарли)**
   - Состояние $|\Phi^+\rangle = (|00\rangle + |11\rangle)/\sqrt{2}$ через H и CNOT.
   - Обеспечивает общий ресурс запутанности до измерений.

3. **Распределение ролей**
   - Итоговое состояние: $|\psi\rangle_A \otimes |\Phi^+\rangle_{CB}$.
   - Запутанность остаётся между B и C, даже если кубиты разнесены.

4. **Беллово измерение у Алисы**
   - Операции: CNOT между кубитами Алисы и Hadamard на первом из них.
   - После измерения достаточно двух классических битов.

5. **Измерение и коллапс**
   - Вероятности $P_{ij} = |c_{ij}|^2$ фиксируют будущую коррекцию.
   - Суперпозиция Алисы исчезает, остаются биты $b_1, b_2$.

6. **Передача результатов Бобу**
   - Классический канал передаёт только $b_1$ и $b_2$.
   - Определяет оператор коррекции $X^{b_2} Z^{b_1}$.

7. **Коррекция у Боба**
   - Локальные вращения X и Z устраняют флип и фазовый сдвиг.
   - Мини-код: `if b1==1: apply_pauli_z(); if b2==1: apply_pauli_x()`.

8. **Восстановление состояния**
   - После коррекции кубит Боба совпадает с исходным $|\psi\rangle$.
   - Исходный вектор у Алисы разрушен, клонирования нет.

## Мини-реплики интерфейса для контекста

- «Беллова пара готова, жду измерения Алисы».
- «Измерение выполнено, отправляю два классических бита».
- «Применяю Pauli-коррекцию и восстанавливаю состояние».
